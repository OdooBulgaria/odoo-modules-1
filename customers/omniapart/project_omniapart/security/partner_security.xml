<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data noupdate="1">

        <record model="ir.rule" id="base.res_partner_rule">
            <field name="name">res.partner company</field>
            <field name="model_id" ref="base.model_res_partner"/>
            <field name="domain_force">['|','|','|',('company_id.child_ids','child_of',[user.company_id.id]),('user_ids','!=',False),('company_id','child_of',[user.company_id.id]),('company_id','=',False)]</field>
        </record>    

	    <record model="ir.rule" id="project.task_visibility_rule">
	        <field name="name">Project/Task: employees: public or employee or (followers and following)</field>
	        <field name="model_id" ref="project.model_project_task"/>
	        <field name="domain_force">['|','|', ('project_id.privacy_visibility', 'in', ['public', 'portal']), '&amp;', ('project_id.privacy_visibility', 'in', ['employee']), ('user_id.id','=',user.id), '&amp;', ('project_id.privacy_visibility', '=', 'followers'), ('message_follower_ids', 'in', [user.partner_id.id]), ]</field>
	        <field name="groups" eval="[(4,ref('base.group_user'))]"/>
	    </record>        

	    <record model="ir.rule" id="task_visibility_rule_hr_omniapart">
	        <field name="name">2 - Project/Task: employees: public or employee or (followers and following)</field>
	        <field name="model_id" ref="project.model_project_task"/>
	        <field name="domain_force">[('message_follower_ids', 'in', [user.partner_id.id])]</field>
	        <field name="groups" eval="[(4,ref('base.group_user'))]"/>
	    </record> 	    
	    
	    <record model="ir.rule" id="user_project_tasks_rule_omniapart">
	        <field name="name">Omniapart - Project/Task: project user: see own</field>
	        <field name="model_id" ref="project.model_project_task"/>
	        <field name="domain_force">['|','|', ('project_id.privacy_visibility', 'in', ['public', 'portal']), '&amp;', ('project_id.privacy_visibility', 'in', ['employee']), ('user_id.id','=',user.id), '&amp;', ('project_id.privacy_visibility', '=', 'followers'), ('message_follower_ids', 'in', [user.partner_id.id]), ]</field>
	        <field name="groups" eval="[(4,ref('project.group_project_manager'))]"/>
	    </record>	 

	    <record model="ir.rule" id="user_project_tasks_rule_omniapart2">
	        <field name="name">2 - Omniapart - Project/Task: project user: see own</field>
	        <field name="model_id" ref="project.model_project_task"/>
	        <field name="domain_force">[('message_follower_ids', 'in', [user.partner_id.id])]</field>
	        <field name="groups" eval="[(4,ref('project.group_project_manager'))]"/>
	    </record>	    	       

	    <record model="ir.rule" id="task_visibility_rule_hr_omniapart_officer">
	        <field name="name">Project/Task: employees manager: public, portal, employee or (followers and following)</field>
	        <field name="model_id" ref="project.model_project_task"/>
	        <field name="domain_force">['|', ('project_id.privacy_visibility', 'in', ['public', 'portal','employee']), '&amp;', ('project_id.privacy_visibility', '=', 'followers'), ('message_follower_ids', 'in', [user.partner_id.id]), ]</field>
	        <field name="groups" eval="[(4,ref('base.group_hr_user'))]"/>
	    </record>	    

        <record model="ir.rule" id="project.project_public_members_rule">
            <field name="name">Project: employees: public, portal, employees or following</field>
            <field name="domain_force">['|','|','|', ('privacy_visibility', 'in', ['public', 'portal']), '&amp;', ('privacy_visibility', '=', 'followers'), '&amp;', ('privacy_visibility', '=', 'employees'), ('members', 'in', [user.id]), ('user_id', '=', [user.id]), ]</field>
            <field name="groups" eval="[(4, ref('base.group_user'))]"/>
        </record>	    
	    	    	    
</data>
</openerp>
